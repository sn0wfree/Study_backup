pcor_tes
jsbl <- c("pAdDeg","successful_rate")   #要计算的相关系数的变量下标
tjbl <- c("GiniCoeff")  #条件(控制)变量的下标，即要排除影响的变量的下标
r<-pcor(c(jsbl,tjbl),cor(se))
q <- length(tjbl)   #计算要控制的变量数
n <- dim(se)[1]  #计算样本量
pcor_test <- pcor.test(r,q,n) #偏相关系数显著性检验结果（输出序号3）
pcor_test
corr.test(se,use="pairwise")
jsbl <- c("GiniCoeff","successful_rate")   #要计算的相关系数的变量下标
tjbl <- c("pAdDeg")  #条件(控制)变量的下标，即要排除影响的变量的下标
r<-pcor(c(jsbl,tjbl),cor(se))
pcor_test.pAdDeg <- pcor.test(r,q,n)
pcor_test.pAdDeg
summary(pcor_test.pAdDeg)
suset(se)
subset(se)
se_s<-se
subset(se_s,drop = "pAdDeg")
subset(se_s,-c("pAdDeg"))
subset(se_s,drop=c("pAdDeg"))
subset(se_s,drop=c(pAdDeg))
subset(se_s,-c("pAdDeg"))
subset(se_s,-c("pAdDeg"))
se_s[,-c("pAdDeg")]
se_s[,-"pAdDeg"]
se_s[,-pAdDeg]
se_s[pAdDeg]
se_s["pAdDeg"]
se_s["pAdDeg"]=NULL
se_s
pcortest_dev<-function(x_set,y,dataset){
require(psych)
require(ggm)
for (x_control in x_set ){
x_subset<-x_set
x_subset[x_control]<-NULL
jsbl <- c(x_subset,y)   #要计算的相关系数的变量下标
tjbl <- c(x_control)  #条件(控制)变量的下标，即要排除影响的变量的下标
r<-pcor(c(jsbl,tjbl),cor(x_set))
q <- length(tjbl)
n <- dim(x_set)[1]
pcor_test[x_control]<- pcor.test(r,q,n)
}
return(pcor_test)
}
pcortest_dev(c("GiniCoeff","pAdDeg"),c("successful_rate"),se)
pcortest_dev<-function(x_set,y,dataset){
require(psych)
require(ggm)
for (num in length(x_set) ){
x_subset<-x_set
x_subset[num]<-NULL
jsbl <- c(x_subset,y)   #要计算的相关系数的变量下标
tjbl <- c(x_control)  #条件(控制)变量的下标，即要排除影响的变量的下标
r<-pcor(c(jsbl,tjbl),cor(x_set))
q <- length(tjbl)
n <- dim(x_set)[1]
pcor_test[x_control]<- pcor.test(r,q,n)
}
return(pcor_test)
}
pcortest_dev<-function(x_set,y,dataset){
require(psych)
require(ggm)
for (num in length(x_set) ){
x_subset<-x_set
x_subset[num]<-NULL
jsbl <- c(x_subset,y)   #要计算的相关系数的变量下标
tjbl <- c(x_control)  #条件(控制)变量的下标，即要排除影响的变量的下标
r<-pcor(c(jsbl,tjbl),cor(x_set))
q <- length(tjbl)
n <- dim(x_set)[1]
pcor_test[col.names(x_set)[num]]<- pcor.test(r,q,n)
}
return(pcor_test)
}
pcortest_dev(c("GiniCoeff","pAdDeg"),c("successful_rate"),se)
se_x[1]
se_s[1]
se_s[,1]
se_s[1,]
se_s[1]
x_subset[col.names(x_set)[num]]<-NULL
pcortest_dev<-function(x_set,y,dataset){
require(psych)
require(ggm)
for (num in length(x_set) ){
x_subset<-x_set
x_subset[col.names(x_set)[num]]<-NULL
jsbl <- c(x_subset,y)   #要计算的相关系数的变量下标
tjbl <- c(x_control)  #条件(控制)变量的下标，即要排除影响的变量的下标
r<-pcor(c(jsbl,tjbl),cor(x_set))
q <- length(tjbl)
n <- dim(x_set)[1]
pcor_test[col.names(x_set)[num]]<- pcor.test(r,q,n)
}
return(pcor_test)
}
pcortest_dev(c("GiniCoeff","pAdDeg"),c("successful_rate"),se)
pcortest_dev<-function(x_set,y,dataset){
require(psych)
require(ggm)
for (num in length(x_set) ){
x_subset<-x_set
x_subset[colnames(x_set)[num]]<-NULL
jsbl <- c(x_subset,y)   #要计算的相关系数的变量下标
tjbl <- c(x_control)  #条件(控制)变量的下标，即要排除影响的变量的下标
r<-pcor(c(jsbl,tjbl),cor(x_set))
q <- length(tjbl)
n <- dim(x_set)[1]
pcor_test[colnames(x_set)[num]]<- pcor.test(r,q,n)
}
return(pcor_test)
}
pcortest_dev(c("GiniCoeff","pAdDeg"),c("successful_rate"),se)
pcortest_dev<-function(x_set,y,dataset){
require(psych)
require(ggm)
for (num in length(x_set) ){
x_subset<-x_set
x_subset[colnames(x_set)[num]]<-NULL
jsbl <- c(x_subset,y)   #要计算的相关系数的变量下标
tjbl <- c(colnames(x_set)[num])  #条件(控制)变量的下标，即要排除影响的变量的下标
r<-pcor(c(jsbl,tjbl),cor(x_set))
q <- length(tjbl)
n <- dim(x_set)[1]
pcor_test[colnames(x_set)[num]]<- pcor.test(r,q,n)
}
return(pcor_test)
}
pcortest_dev(c("GiniCoeff","pAdDeg"),c("successful_rate"),se)
pcortest_dev<-function(x_set,y,dataset){
require(psych)
require(ggm)
for (np in colnames(x_set) ){
x_subset<-x_set
x_subset[n]<-NULL
jsbl <- c(x_subset,y)   #要计算的相关系数的变量下标
tjbl <- c(np)  #条件(控制)变量的下标，即要排除影响的变量的下标
r<-pcor(c(jsbl,tjbl),cor(dataset))
q <- length(tjbl)
n <- dim(dataset)[1]
pcor_test[np]<- pcor.test(r,q,n)
}
return(pcor_test)
}
pcortest_dev(c("GiniCoeff","pAdDeg"),c("successful_rate"),se)
pcortest_dev<-function(x_set,y,dataset){
require(psych)
require(ggm)
for (np in colnames(x_set) ){
x_subset<-x_set
x_subset[n]<-NULL
jsbl <- c(x_subset,y)   #要计算的相关系数的变量下标
tjbl <- c(np)  #条件(控制)变量的下标，即要排除影响的变量的下标
r<-pcor(c(jsbl,tjbl),cor(dataset))
q <- length(tjbl)
n <- dim(dataset)[1]
pcor_test<- pcor.test(r,q,n)
print(pcor_test)
}
return(pcor_test)
}
pcortest_dev(c("GiniCoeff","pAdDeg"),c("successful_rate"),se)
pcortest_dev<-function(x_set,y,dataset){
require(psych)
require(ggm)
for (np in x_set ){
x_subset<-x_set
x_subset[n]<-NULL
jsbl <- c(x_subset,y)   #要计算的相关系数的变量下标
tjbl <- c(np)  #条件(控制)变量的下标，即要排除影响的变量的下标
r<-pcor(c(jsbl,tjbl),cor(dataset))
q <- length(tjbl)
n <- dim(dataset)[1]
pcor_test<- pcor.test(r,q,n)
print(pcor_test)
}
return(pcor_test)
}
pcortest_dev(c("GiniCoeff","pAdDeg"),c("successful_rate"),se)
pcortest_dev<-function(x_set,y,dataset){
require(psych)
require(ggm)
for (np in x_set ){
x_subset<-x_set
x_subset[np]<-NULL
jsbl <- c(x_subset,y)   #要计算的相关系数的变量下标
tjbl <- c(np)  #条件(控制)变量的下标，即要排除影响的变量的下标
r<-pcor(c(jsbl,tjbl),cor(dataset))
q <- length(tjbl)
n <- dim(dataset)[1]
pcor_test<- pcor.test(r,q,n)
print(pcor_test)
}
return(pcor_test)
}
pcortest_dev(c("GiniCoeff","pAdDeg"),c("successful_rate"),se)
pcortest_dev<-function(x_set,y,dataset){
require(psych)
require(ggm)
for (np in x_set ){
print (np)
x_subset<-x_set
x_subset[np]<-NULL
jsbl <- c(x_subset,y)   #要计算的相关系数的变量下标
tjbl <- c(np)  #条件(控制)变量的下标，即要排除影响的变量的下标
r<-pcor(c(jsbl,tjbl),cor(dataset))
q <- length(tjbl)
n <- dim(dataset)[1]
pcor_test<- pcor.test(r,q,n)
print(pcor_test)
}
return(pcor_test)
}
pcortest_dev(c("GiniCoeff","pAdDeg"),c("successful_rate"),se)
pcortest_dev<-function(x_set,y,dataset){
require(psych)
require(ggm)
for (np in x_set ){
print (np)
x_subset<-dataset
x_subset[np]<-NULL
jsbl <- c(x_subset,y)   #要计算的相关系数的变量下标
tjbl <- c(np)  #条件(控制)变量的下标，即要排除影响的变量的下标
r<-pcor(c(jsbl,tjbl),cor(dataset))
q <- length(tjbl)
n <- dim(dataset)[1]
pcor_test<- pcor.test(r,q,n)
print(pcor_test)
}
return(pcor_test)
}
pcortest_dev(c("GiniCoeff","pAdDeg"),c("successful_rate"),se)
pcortest_dev<-function(x_set,y,dataset){
require(psych)
require(ggm)
for (np in x_set ){
data_subset<-dataset
data_subset[np]<-NULL
x_subset=x_set[-np]
jsbl <- c(x_subset,y)   #要计算的相关系数的变量下标
tjbl <- c(np)  #条件(控制)变量的下标，即要排除影响的变量的下标
r<-pcor(c(jsbl,tjbl),cor(dataset))
q <- length(tjbl)
n <- dim(dataset)[1]
pcor_test<- pcor.test(r,q,n)
print(pcor_test)
}
return(pcor_test)
}
pcortest_dev(c("GiniCoeff","pAdDeg"),c("successful_rate"),se)
pcortest_dev<-function(x_set,y,dataset){
require(psych)
require(ggm)
for (nv in length(x_set) ){
data_subset<-dataset
data_subset[x_set[np]]<-NULL
x_subset=x_set[-np]
jsbl <- c(x_subset,y)   #要计算的相关系数的变量下标
tjbl <- c(np)  #条件(控制)变量的下标，即要排除影响的变量的下标
r<-pcor(c(jsbl,tjbl),cor(dataset))
q <- length(tjbl)
n <- dim(dataset)[1]
pcor_test<- pcor.test(r,q,n)
print(pcor_test)
}
return(pcor_test)
}
pcortest_dev(c("GiniCoeff","pAdDeg"),c("successful_rate"),se)
pcortest_dev<-function(x_set,y,dataset){
require(psych)
require(ggm)
for (nv in length(x_set) ){
data_subset<-dataset
data_subset[x_set[nv]]<-NULL
x_subset=x_set[-nv]
jsbl <- c(x_subset,y)   #要计算的相关系数的变量下标
tjbl <- c(x_set[nv])  #条件(控制)变量的下标，即要排除影响的变量的下标
r<-pcor(c(jsbl,tjbl),cor(dataset))
q <- length(tjbl)
n <- dim(dataset)[1]
pcor_test<- pcor.test(r,q,n)
print(pcor_test)
}
return(pcor_test)
}
pcortest_dev(c("GiniCoeff","pAdDeg"),c("successful_rate"),se)
pcortest_dev<-function(x_set,y,dataset){
require(psych)
require(ggm)
for (nv in length(x_set) ){
data_subset<-dataset
data_subset[x_set[nv]]<-NULL
x_subset=x_set[-nv]
jsbl <- c(x_subset,y)   #要计算的相关系数的变量下标
tjbl <- c(x_set[nv])  #条件(控制)变量的下标，即要排除影响的变量的下标
r<-pcor(c(jsbl,tjbl),cor(dataset))
q <- length(tjbl)
n <- dim(dataset)[1]
pcor_test<- pcor.test(r,q,n)
print("control",x_set[nv])
print(pcor_test)
}
return(pcor_test)
}
pcortest_dev(c("GiniCoeff","pAdDeg"),c("successful_rate"),se)
pcortest_dev<-function(x_set,y,dataset){
require(psych)
require(ggm)
for (nv in length(x_set) ){
data_subset<-dataset
data_subset[x_set[nv]]<-NULL
x_subset=x_set[-nv]
jsbl <- c(x_subset,y)   #要计算的相关系数的变量下标
tjbl <- c(x_set[nv])  #条件(控制)变量的下标，即要排除影响的变量的下标
r<-pcor(c(jsbl,tjbl),cor(dataset))
q <- length(tjbl)
n <- dim(dataset)[1]
pcor_test<- pcor.test(r,q,n)
print("control"+x_set[nv])
print(pcor_test)
}
return(pcor_test)
}
pcortest_dev(c("GiniCoeff","pAdDeg"),c("successful_rate"),se)
print ("a = "a)
print ("a = %"%a)
?print
print(c("a",a))
a<-1
print(c("a",a))
print(c("a ="a))
print(("a ="a))
print(("a =",a))
print(("a = %d"))
print(("a = %/n"))
print(("a = %/n"\n))
pcortest_dev<-function(x_set,y,dataset){
require(psych)
require(ggm)
for (nv in length(x_set) ){
data_subset<-dataset
data_subset[x_set[nv]]<-NULL
x_subset=x_set[-nv]
jsbl <- c(x_subset,y)   #要计算的相关系数的变量下标
tjbl <- c(x_set[nv])  #条件(控制)变量的下标，即要排除影响的变量的下标
r<-pcor(c(jsbl,tjbl),cor(dataset))
q <- length(tjbl)
n <- dim(dataset)[1]
pcor_test<- pcor.test(r,q,n)
print(x_set[nv])
print(pcor_test)
}
return(pcor_test)
}
pcortest_dev(c("GiniCoeff","pAdDeg"),c("successful_rate"),se)
pcortest_dev<-function(x_set,y,dataset){
require(psych)
require(ggm)
for (nv in length(x_set) ){
data_subset<-dataset
data_subset[x_set[nv]]<-NULL
x_subset=x_set[-nv]
jsbl <- c(x_subset,y)   #要计算的相关系数的变量下标
tjbl <- c(x_set[nv])  #条件(控制)变量的下标，即要排除影响的变量的下标
r<-pcor(c(jsbl,tjbl),cor(dataset))
q <- length(tjbl)
n <- dim(dataset)[1]
print(x_set[nv])
pcor_test<- pcor.test(r,q,n)
print(pcor_test)
}
return(pcor_test)
}
pcortest_dev(c("GiniCoeff","pAdDeg"),c("successful_rate"),se)
pcortest_dev<-function(x_set,y,dataset){
require(psych)
require(ggm)
for (nv in length(x_set) ){
data_subset<-dataset
data_subset[x_set[nv]]<-NULL
x_subset=x_set
x_subset=x_subset[-nv]
jsbl <- c(x_subset,y)   #要计算的相关系数的变量下标
tjbl <- c(x_set[nv])  #条件(控制)变量的下标，即要排除影响的变量的下标
r<-pcor(c(jsbl,tjbl),cor(dataset))
q <- length(tjbl)
n <- dim(dataset)[1]
print(x_set[nv])
pcor_test<- pcor.test(r,q,n)
print(pcor_test)
}
return(pcor_test)
}
pcortest_dev(c("GiniCoeff","pAdDeg"),c("successful_rate"),se)
jsbl <- c("GiniCoeff","successful_rate")   #要计算的相关系数的变量下标
tjbl <- c("pAdDeg")  #条件(控制)变量的下标，即要排除影响的变量的下标
r<-pcor(c(jsbl,tjbl),cor(se))
q <- length(tjbl)   #计算要控制的变量数
n <- dim(se)[1]  #计算样本量
pcor_test.GiniCoeff <- pcor.test(r,q,n) #偏相关系数显著性检验结果（输出序号3）
pcor_test.GiniCoeff
jsbl <- c("pAdDeg","successful_rate")   #要计算的相关系数的变量下标
tjbl <- c("GiniCoeff")  #条件(控制)变量的下标，即要排除影响的变量的下标
r<-pcor(c(jsbl,tjbl),cor(se))
q <- length(tjbl)   #计算要控制的变量数
n <- dim(se)[1]  #计算样本量
pcor_test.pAdDeg <- pcor.test(r,q,n)
pcor_test.pAdDeg
r
r.pAdDeg=r
jsbl <- c("GiniCoeff","successful_rate")   #要计算的相关系数的变量下标
tjbl <- c("pAdDeg")  #条件(控制)变量的下标，即要排除影响的变量的下标
r<-pcor(c(jsbl,tjbl),cor(se))
r.GiniCoeff=r
r
a_temp=lm(crowdfunding$successful_rate~crowdfunding$GiniCoeff)
b_temp=lm(crowdfunding$pAdDeg~crowdfunding$GiniCoeff)
cor.test(a_temp$residuals,b_temp$residuals)
a2_temp=lm(crowdfunding$successful_rate~crowdfunding$pAdDeg)
b2_temp=lm(crowdfunding$GiniCoeff~crowdfunding$pAdDeg)
cor.test(a2_temp$residuals,b2_temp$residuals)
cor.test(a2_temp$residuals,b2_temp$residuals,method="spearman")
temp<-rnorm(1:20)
temp
temp<-c(temp,runif(1:200))
plot(temp)
plot(temp)
points(lowess(temp),type="l")
temp<-c(rnorm(1:200),runif(1:200))
plot(temp)
points(lowess(temp),type="l")
temp<-c(rnorm(1:200),runif(1:200))
plot(temp)
points(lowess(temp),type="l",col="red")
temp<-c(rnorm(1:200),runif(1:200))
plot(temp)
points(lowess(temp),type="l",col="red",cex=2)
temp<-c(rnorm(1:200),runif(1:200))
plot(temp)
points(lowess(temp),type="l",col="red",cex=2)
temp<-c(rnorm(1:200,50),runif(1:200))
temp<-c(rnorm(1:200,50),runif(1:200))
plot(temp)
points(lowess(temp),type="l",col="red",cex=2)
temp<-c(rnorm(1:200,50)
temp2<-c(runif(1:200,50))
temp<-c(rnorm(1:200,50)
temp2<-c(runif(1:200))
temp<-c(rnorm(1:200)
temp2<-c(runif(1:200))
temp<-c(rnorm(1,200,50)
temp2<-c(runif(1:200,50))
temp<-c(rnorm(1,200,50))
temp<-c(rnorm(1,200,50))
temp2<-c(runif(1:200,50))
par(mforw=c(1,2))
plot(temp)
ploet(temp2)
temp<-c(rnorm(1,200,50))
temp2<-c(runif(1:200))
par(mforw=c(1,2))
plot(temp)
ploet(temp2)
temp<-c(rnorm(1,200))
temp2<-c(runif(1:200))
par(mforw=c(1,2))
plot(temp)
ploet(temp2)
temp<-c(rnorm(2,50))
temp2<-c(runif(1:200))
par(mforw=c(1,2))
plot(temp)
ploet(temp2)
temp<-rnorm(2,50)
temp
temp<-rnorm(2,50,n=10)
temp
temp<-rnorm(2,50,n=10)
temp
temp2<-c(runif(n = 10,1:200))
par(mforw=c(1,2))
plot(temp)
ploet(temp2)
temp2<-c(runif(n = 10))
temp2
temp<-rnorm(2,50,n=10)
temp
temp2<-c(runif(n = 10))
temp2
par(mforw=c(1,2))
plot(temp)
ploet(temp2)
temp<-rnorm(2,50,n=10)
temp
temp2<-c(runif(n = 10))
temp2
par(mforw=c(1,2))
plot(temp)
plot(temp2)
plot(temp~temp2)
points(lowess(temp~temp2))
plot(temp~temp2)
points(lowess(temp~temp2))
plot(temp~temp2)
points(lowess(temp~temp2),type="l")
plot(temp~temp2)
points(lm(temp~temp2),type="l")
plot(lm(temp~temp2))
plot(temp~temp2)
